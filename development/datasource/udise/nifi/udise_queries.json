[
    {
        "udise_management_district": "select * from udise_district_mgt_score"
    },
    {
        "udise_management_block": "select b.*,c.block_level_rank_within_the_state, c.block_level_rank_within_the_district from udise_block_mgt_score as b left join(select usc.block_id,infrastructure_score,a.school_management_type, ( ( Rank() over ( PARTITION BY a.district_id,a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.blocks_in_district) ) AS block_level_rank_within_the_district, ( ( Rank() over (PARTITION BY a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) ||  a.total_blocks) AS block_level_rank_within_the_state from udise_block_mgt_score as usc left join (select a.*,(select count(DISTINCT(block_id)) from udise_school_metrics_agg where school_management_type=a.school_management_type)as total_blocks from (select distinct(scl.block_id),blocks_in_district,d.district_id,scl.school_management_type from udise_school_metrics_agg as scl left join (SELECT district_id,Count(DISTINCT block_id) AS blocks_in_district,school_management_type FROM  udise_school_metrics_agg where school_management_type is not null group by district_id,school_management_type)as d on scl.district_id=d.district_id and scl.school_management_type=d.school_management_type)as a)as a on usc.block_id=a.block_id and usc.school_management_type=a.school_management_type group by infrastructure_score,a.school_management_type ,usc.block_id,a.total_blocks,a.district_id) as c ON b.block_id = c.block_id and b.school_management_type=c.school_management_type;"
    },
    {
        "udise_management_cluster": "select b.*,c.cluster_level_rank_within_the_state, c.cluster_level_rank_within_the_district,c.cluster_level_rank_within_the_block from udise_cluster_mgt_score as b left join(select usc.cluster_id,infrastructure_score,a.school_management_type, ( ( Rank() over ( PARTITION BY a.block_id,a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.clusters_in_block) ) AS cluster_level_rank_within_the_block, ( ( Rank() over ( PARTITION BY a.district_id,a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.clusters_in_district) ) AS cluster_level_rank_within_the_district, ( ( Rank() over ( PARTITION BY a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) ||  a.total_clusters) AS cluster_level_rank_within_the_state from udise_cluster_mgt_score as usc left join (select a.*,(select count(DISTINCT(cluster_id)) from udise_school_metrics_agg where school_management_type=a.school_management_type)as total_clusters from (select distinct(scl.cluster_id),clusters_in_block,b.block_id,clusters_in_district,d.district_id,scl.school_management_type from udise_school_metrics_agg as scl left join (SELECT block_id,Count(DISTINCT udise_school_metrics_agg.cluster_id) AS clusters_in_block,school_management_type FROM udise_school_metrics_agg where school_management_type is not null group by block_id,school_management_type)as b on scl.block_id=b.block_id and scl.school_management_type=b.school_management_type left join (SELECT district_id,Count(DISTINCT udise_school_metrics_agg.cluster_id) AS clusters_in_district,school_management_type FROM udise_school_metrics_agg where school_management_type is not null group by district_id,school_management_type) as d on scl.district_id=d.district_id and scl.school_management_type=d.school_management_type)as a)as a on usc.cluster_id=a.cluster_id and usc.school_management_type=a.school_management_type group by infrastructure_score,a.school_management_type ,usc.cluster_id,a.total_clusters,a.block_id,a.district_id) as c ON b.cluster_id = c.cluster_id and b.school_management_type=c.school_management_type; "
    },
    {
        "udise_management_school": "select b.*,c.school_level_rank_within_the_state, c.school_level_rank_within_the_district,c.school_level_rank_within_the_block,c.school_level_rank_within_the_cluster from udise_school_mgt_score as b left join(select usc.udise_school_id,infrastructure_score,a.school_management_type, ( ( Rank() over ( PARTITION BY a.cluster_id,a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.schools_in_cluster) ) AS school_level_rank_within_the_cluster, ( ( Rank() over ( PARTITION BY a.block_id,a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.schools_in_block) ) AS school_level_rank_within_the_block, ( ( Rank() over ( PARTITION BY a.district_id,a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.schools_in_district) ) AS school_level_rank_within_the_district, ( ( Rank() over ( PARTITION BY a.school_management_type ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) ||  a.total_schools) AS school_level_rank_within_the_state from udise_school_mgt_score as usc left join (select a.*,(select count(DISTINCT(udise_school_id)) from udise_school_metrics_agg where school_management_type=a.school_management_type)as total_schools from (select udise_school_id,c.cluster_id,schools_in_cluster,b.block_id,schools_in_block,d.district_id,schools_in_district,scl.school_management_type from udise_school_metrics_agg as scl left join (SELECT cluster_id,Count(DISTINCT udise_school_metrics_agg.udise_school_id) AS schools_in_cluster,school_management_type FROM udise_school_metrics_agg where school_management_type is not null group by cluster_id,school_management_type) as c on scl.cluster_id=c.cluster_id left join (SELECT block_id,Count(DISTINCT udise_school_metrics_agg.udise_school_id) AS schools_in_block,school_management_type FROM udise_school_metrics_agg where school_management_type is not null group by block_id,school_management_type)as b on scl.block_id=b.block_id and scl.school_management_type=b.school_management_type left join (SELECT district_id,Count(DISTINCT udise_school_metrics_agg.udise_school_id) AS schools_in_district,school_management_type FROM udise_school_metrics_agg where school_management_type is not null  group by district_id,school_management_type) as d on scl.district_id=d.district_id and scl.school_management_type=d.school_management_type)as a)as a on usc.udise_school_id=a.udise_school_id and usc.school_management_type=a.school_management_type group by usc.udise_school_id,infrastructure_score,a.school_management_type ,a.cluster_id,a.block_id,a.district_id,a.total_schools) as c ON b.udise_school_id = c.udise_school_id and b.school_management_type=c.school_management_type;"
    },
    {
        "udise_district_wise_qry": "select * from udise_district_score"
    },
    {
        "udise_block_wise_qry": "select b.*,c.block_level_rank_within_the_state, c.block_level_rank_within_the_district from udise_block_score as b left join(select usc.block_id,infrastructure_score, ( ( Rank() over ( PARTITION BY a.district_id ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.blocks_in_district) ) AS block_level_rank_within_the_district, ( ( Rank() over ( ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) ||  a.total_blocks) AS block_level_rank_within_the_state from udise_block_score as usc left join (select a.*,(select count(DISTINCT(block_id)) from udise_school_metrics_agg)as total_blocks from (select distinct(scl.block_id),blocks_in_district,d.district_id from udise_school_metrics_agg as scl left join (SELECT district_id,Count(DISTINCT udise_school_metrics_agg.block_id) AS blocks_in_district FROM   udise_school_metrics_agg group by district_id)as d on scl.district_id=d.district_id)as a)as a on usc.block_id=a.block_id group by infrastructure_score ,usc.block_id,a.total_blocks,a.district_id) as c ON b.block_id = c.block_id ; "
    },
    {
        "udise_cluster_wise_qry": "select b.*,c.cluster_level_rank_within_the_state, c.cluster_level_rank_within_the_district,c.cluster_level_rank_within_the_block from udise_cluster_score as b left join(select usc.cluster_id,infrastructure_score, ( ( Rank() over ( PARTITION BY a.block_id ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.clusters_in_block) ) AS cluster_level_rank_within_the_block, ( ( Rank() over ( PARTITION BY a.district_id ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.clusters_in_district) ) AS cluster_level_rank_within_the_district, ( ( Rank() over ( ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) ||  a.total_clusters) AS cluster_level_rank_within_the_state from udise_cluster_score as usc left join (select a.*,(select count(DISTINCT(cluster_id)) from udise_school_metrics_agg)as total_clusters from (select distinct(scl.cluster_id),clusters_in_block,b.block_id,clusters_in_district,d.district_id from udise_school_metrics_agg as scl left join (SELECT block_id,Count(DISTINCT udise_school_metrics_agg.cluster_id) AS clusters_in_block FROM   udise_school_metrics_agg group by block_id)as b on scl.block_id=b.block_id left join (SELECT district_id,Count(DISTINCT udise_school_metrics_agg.cluster_id) AS clusters_in_district FROM   udise_school_metrics_agg group by district_id) as d on scl.district_id=d.district_id)as a)as a on usc.cluster_id=a.cluster_id group by infrastructure_score ,usc.cluster_id,a.total_clusters,a.block_id,a.district_id) as c ON b.cluster_id = c.cluster_id ; "
    },
    {
        "udise_school_wise_qry": "select b.*,c.school_level_rank_within_the_state, c.school_level_rank_within_the_district,c.school_level_rank_within_the_block,c.school_level_rank_within_the_cluster from udise_school_score as b left join(select usc.udise_school_id,infrastructure_score, ( ( Rank() over ( PARTITION BY a.cluster_id ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.schools_in_cluster) ) AS school_level_rank_within_the_cluster, ( ( Rank() over ( PARTITION BY a.block_id ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.schools_in_block) ) AS school_level_rank_within_the_block, ( ( Rank() over ( PARTITION BY a.district_id ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) || sum(a.schools_in_district) ) AS school_level_rank_within_the_district, ( ( Rank() over ( ORDER BY usc.infrastructure_score DESC) || ' out of ' :: text ) ||  a.total_schools) AS school_level_rank_within_the_state from udise_school_score as usc left join (select a.*,(select count(DISTINCT(udise_school_id)) from udise_school_metrics_agg)as total_schools from (select udise_school_id,c.cluster_id,schools_in_cluster,b.block_id,schools_in_block,d.district_id,schools_in_district from udise_school_metrics_agg as scl left join (SELECT cluster_id,Count(DISTINCT udise_school_metrics_agg.udise_school_id) AS schools_in_cluster FROM   udise_school_metrics_agg group by cluster_id) as c on scl.cluster_id=c.cluster_id left join (SELECT block_id,Count(DISTINCT udise_school_metrics_agg.udise_school_id) AS schools_in_block FROM   udise_school_metrics_agg group by block_id)as b on scl.block_id=b.block_id left join (SELECT district_id,Count(DISTINCT udise_school_metrics_agg.udise_school_id) AS schools_in_district FROM   udise_school_metrics_agg group by district_id) as d on scl.district_id=d.district_id)as a)as a on usc.udise_school_id=a.udise_school_id group by usc.udise_school_id,infrastructure_score ,a.cluster_id,a.block_id,a.district_id,a.total_schools) as c ON b.udise_school_id = c.udise_school_id ;"
    }
]