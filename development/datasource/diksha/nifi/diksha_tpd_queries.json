[
    {
        "diksha_tpd_district_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.district_id=sde.district_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_block_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.block_id=sde.block_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_cluster_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.cluster_id=sde.cluster_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_school_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/Nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.school_id=sde.school_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.school_id,a.school_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_r2_district_last_day": "select district_id,district_name,collection_id,collection_name,'collections' as type,'district'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion, 'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name"
    },
    {
        "diksha_tpd_r2_district_last_7_days": "select district_id,district_name,collection_id,collection_name,'collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name"
    },
    {
        "diksha_tpd_r2_district_last_30_days": "select district_id,district_name,collection_id,collection_name,'collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name"
    },
    {
        "diksha_tpd_r2_district_overall": "select district_id,district_name,collection_id,collection_name,'collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name union select district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'district' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by district_id,district_name"
    },
    {
        "diksha_tpd_r2_block_last_day": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_block_last_7_days": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_block_last_30_days": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_block_overall": "select block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg  group by block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_cluster_last_day": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_cluster_last_7_days": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'Cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_cluster_last_30_days": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_cluster_overall": "select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_school_last_day": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school 'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_school_last_7_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_school_last_30_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_school_overall": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,'0' as collection_id,'All' as collection_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name"
    },
    {
        "diksha_tpd_r2_raw_last_day": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school 'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_last_7_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_last_30_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_overall": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    }
]