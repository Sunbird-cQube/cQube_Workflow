[
  {
    "stud_att_meta": "select count(distinct(district_id)) as total_districts, count(distinct(block_id))as total_blocks, count(distinct(cluster_id))as total_clusters, count(distinct(school_id))as total_schools, cast(sum(students_count)/count(distinct(month)) as int)as total_students ,(select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date),month,TO_CHAR( TO_DATE (month::text, 'MM'), 'Month' ) AS month_name,case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year from school_student_total_attendance group by month,year; "
  },
  {
    "stud_att_line_chart_state": "SELECT Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date),case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY year,month;"
  },
  {
    "stud_att_management_category_line_chart_state": "SELECT school_management_type, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date), case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 and school_management_type is not null GROUP BY year,month,school_management_type;"
  },
  {
    "stud_att_district_wise": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value, 'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) ,case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY district_id,district_latitude,district_longitude,district_name ,year,month "
  },
  {
    "stud_att_block_wise": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) ,case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,year,month "
  },
  {
    "stud_att_cluster_wise": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date), case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,year,month "
  },
  {
    "stud_att_school_wise": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id, INITCAP(cluster_name) AS cluster_name,INITCAP(crc_name)AS crc_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date), case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY school_id,school_name,crc_name,school_latitude,school_longitude,year,month,cluster_id,cluster_name,crc_name,block_id,block_name,district_id,district_name,year,month "
  },
  {
    "stud_att_management_category_district_by_month_year": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value, 'latitude' AS y_axis,district_latitude AS y_value, 'longitude' AS z_axis,district_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) , school_management_type,'overall_category' as school_category,case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 AND school_management_type IS NOT NULL GROUP BY district_id,district_latitude,district_longitude,district_name,school_management_type,year,month; "
  },
  {
    "stud_att_management_category_block_by_month_year": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value, 'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) ,school_management_type,'overall_category' as school_category, case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 AND school_management_type IS NOT NULL GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,school_management_type,year,month; "
  },
  {
    "stud_att_management_category_cluster_by_month_year": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) ,school_management_type,'overall_category' as school_category, case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 AND school_management_type IS NOT NULL GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,school_management_type,year,month; "
  },
  {
    "stud_att_management_category_school_by_month_year": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id, INITCAP(cluster_name) AS cluster_name,INITCAP(crc_name)AS crc_name, Round(Sum(total_present)*100.0/Sum(total_working_days),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value, 'longitude' AS z_axis,school_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) , school_management_type,'overall_category' as school_category, case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as year,month FROM school_student_total_attendance WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 AND school_management_type IS NOT NULL GROUP BY school_id,school_name,crc_name,school_latitude,school_longitude,cluster_id,cluster_name,crc_name,block_id,block_name,district_id,district_name,school_management_type,year,month; "
  },
  {
    "stud_att_management_category_school_last_day": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id, INITCAP(cluster_name) AS cluster_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis, school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_1_day WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_school_last_7_days": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id, INITCAP(cluster_name) AS cluster_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis, school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_7_days WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_school_last_30_day": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id, INITCAP(cluster_name) AS cluster_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis, school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_30_days WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_school_overall": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id, INITCAP(cluster_name) AS cluster_name,school_management_type,'overall_category' as school_category,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis, school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,data_from_date,data_upto_date FROM student_attendance_agg_overall WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name,school_management_type,data_from_date,data_upto_date; "
  },
  {
    "stud_att_management_category_cluster_last_day": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name, school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value, 'longitude' AS z_axis,cluster_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_1_day WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_cluster_last_7_days": " SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name, school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value, 'longitude' AS z_axis,cluster_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_7_days WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_cluster_last_30_days": " SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name, school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value, 'longitude' AS z_axis,cluster_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_30_days WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_cluster_overall": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name, school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value, 'longitude' AS z_axis,cluster_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,data_from_date, data_upto_date FROM student_attendance_agg_overall WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name,school_management_type,data_from_date,data_upto_date; "
  },
  {
    "stud_att_management_category_block_last_day": " SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_1_day WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_block_last_7_days": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_7_days WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_block_last_30_days": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name, district_id,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis, block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_30_days WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_block_overall": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,data_from_date,data_upto_date FROM student_attendance_agg_overall WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name,school_management_type,data_from_date,data_upto_date; "
  },
  {
    "stud_att_management_category_district_last_day": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value, 'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_1_day WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY district_id,district_latitude,district_longitude,district_name,school_management_type ; "
  },
  {
    "stud_att_management_category_district_last_7_days": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value, 'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_7_days WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY district_id,district_latitude,district_longitude,district_name,school_management_type ; "
  },
  {
    "stud_att_management_category_district_last_30_days": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value, 'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_30_days WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY district_id,district_latitude,district_longitude,district_name,school_management_type; "
  },
  {
    "stud_att_management_category_district_overall": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,school_management_type,'overall_category' as school_category, Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value, 'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value, Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,data_from_date,data_upto_date FROM student_attendance_agg_overall WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 AND school_management_type IS NOT NULL GROUP BY district_id,district_latitude,district_longitude,district_name,school_management_type,data_from_date,data_upto_date; "
  },
  {
    "stud_att_district_last_day": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_1_day WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY district_id,district_latitude,district_longitude,district_name ;"
  },
  {
    "stud_att_district_last_7_days": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_7_days WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY district_id,district_latitude,district_longitude,district_name ;"
  },
  {
    "stud_att_district_last_30_days": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_30_days WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY district_id,district_latitude,district_longitude,district_name ;"
  },
  {
    "stud_att_district_overall": "SELECT district_id AS x_axis,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,district_latitude AS y_value,'longitude' AS z_axis,district_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt)FROM student_attendance_agg_overall WHERE district_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY district_id,district_latitude,district_longitude,district_name ;"
  },
  {
    "stud_att_block_last_day": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_1_day WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name;"
  },
  {
    "stud_att_block_last_7_days": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_7_days WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name;"
  },
  {
    "stud_att_block_last_30_days": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_30_days WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name;"
  },
  {
    "stud_att_block_overall": "SELECT block_id AS x_axis,INITCAP(block_name) AS block_name,district_id,INITCAP(district_name) AS district_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,block_latitude AS y_value,'longitude' AS z_axis,block_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt)FROM student_attendance_agg_overall WHERE block_name IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY block_id,block_name,block_latitude,block_longitude,district_id,district_name;"
  },
  {
    "stud_att_cluster_last_day": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_1_day WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_cluster_last_7_days": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_7_days WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_cluster_last_30_days": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) FROM student_attendance_agg_last_30_days WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_cluster_overall": "SELECT cluster_id AS x_axis,INITCAP(cluster_name) AS cluster_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name) AS block_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,cluster_latitude AS y_value,'longitude' AS z_axis,cluster_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt)FROM student_attendance_agg_overall WHERE cluster_latitude IS NOT NULL AND block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY cluster_id,cluster_name,cluster_latitude,cluster_longitude,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_school_last_day": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id,INITCAP(cluster_name) AS cluster_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_1_day WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_school_last_7_days": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id,INITCAP(cluster_name) AS cluster_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_7_days WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_school_last_30_days": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id,INITCAP(cluster_name) AS cluster_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)FROM student_attendance_agg_last_30_days WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_school_overall": "SELECT school_id AS x_axis,INITCAP(school_name) AS school_name,district_id,INITCAP(district_name) AS district_name,block_id,INITCAP(block_name)AS block_name,cluster_id,INITCAP(cluster_name) AS cluster_name,Round(Sum(total_present)*100.0/Sum(total_students),1)AS x_value,'latitude' AS y_axis,school_latitude AS y_value,'longitude' AS z_axis,school_longitude AS z_value,Sum(students_count) AS students_count,Count(DISTINCT(school_id)) AS total_schools,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) FROM student_attendance_agg_overall WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_students>0 GROUP BY school_id,school_name,school_latitude,school_longitude,cluster_id,cluster_name,block_id,block_name,district_id,district_name;"
  },
  {
    "stud_att_exception_meta": "select count(distinct(district_id)) as total_districts, count(distinct(block_id))as total_blocks, count(distinct(cluster_id))as total_clusters,count(distinct(school_id))as total_schools,(select Data_from_date(Min(year),min(month)) from student_attendance_exception_agg where year = (select min(year) from student_attendance_exception_agg) group by year), (select Data_upto_date(Max(year),max(month)) from student_attendance_exception_agg where year = (select max(year) from student_attendance_exception_agg) group by year),month,TO_CHAR(TO_DATE (month::text, 'MM'), 'Month') AS month_name,year from student_attendance_exception_agg group by month,year;"
  },
  {
    "stud_att_management_exception_district_by_month_year": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year,(select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from (select district_id ,district_name,district_latitude,district_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received,month,year,school_management_type from student_attendance_exception_agg where school_management_type is not null group by district_id,district_name,district_latitude,district_longitude,month,year,school_management_type )as a join (select a.district_id,a.school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id,a.school_management_type)as b on a.district_id=b.district_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_block_by_month_year": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year,(select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received,month,year,school_management_type from student_attendance_exception_agg where school_management_type is not null group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,month,year,school_management_type )as a join (select a.block_id,school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id,a.school_management_type)as b on a.block_id=b.block_id and a.school_management_type=b.school_management_type "
  },
  {
    "stud_att_management_exception_cluster_by_month_year": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.school_management_type, a.total_schools_not_received as Total_schools_with_missing_data, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year,(select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,month,year,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_agg where school_management_type is not null group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,month,year,school_management_type )as a join (select a.cluster_id,a.school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id,a.school_management_type)as b on a.cluster_id=b.cluster_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_school_by_month_year": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_management_type, Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,month,year,(select Data_from_date(year,month)), (select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from student_attendance_exception_agg where school_management_type is not null group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,month,year,school_management_type "
  },
  {
    "stud_att_management_exception_district_last_day": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.school_management_type, a.total_schools_not_received as Total_schools_with_missing_data, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,district_latitude,district_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_lastday where school_management_type is not null group by district_id,district_name,district_latitude,district_longitude,school_management_type )as a join (select a.district_id,a.school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id,a.school_management_type)as b on a.district_id=b.district_id  and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_block_last_day": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.school_management_type, a.total_schools_not_received as Total_schools_with_missing_data, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_lastday where school_management_type is not null group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type )as a join (select a.block_id,a.school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id,a.school_management_type)as b on a.block_id=b.block_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_cluster_last_day": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_lastday where school_management_type is not null group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,school_management_type )as a join (select a.cluster_id,school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id,a.school_management_type)as b on a.cluster_id=b.cluster_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_school_last_day": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_management_type, Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from student_attendance_exception_data_lastday where school_management_type is not null group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,school_management_type "
  },
  {
    "stud_att_management_exception_district_last_7_days": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,district_latitude,district_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last7 where school_management_type is not null group by district_id,district_name,district_latitude,district_longitude,school_management_type )as a join (select a.district_id,a.school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id,a.school_management_type)as b on a.district_id=b.district_id  and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_block_last_7_days": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last7 where school_management_type is not null group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type )as a join (select a.block_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id,school_management_type)as b on a.block_id=b.block_id  and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_cluster_last_7_days": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last7 where school_management_type is not null group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,school_management_type )as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id,a.school_management_type)as b on a.cluster_id=b.cluster_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_school_last_7_days": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_management_type, Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from student_attendance_exception_data_last7 where school_management_type is not null group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,school_management_type "
  },
  {
    "stud_att_management_exception_district_last_30_days": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,district_latitude,district_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last30 where school_management_type is not null group by district_id,district_name,district_latitude,district_longitude,school_management_type )as a join (select a.district_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id,a.school_management_type)as b on a.district_id=b.district_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_block_last_30_days": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last30 where school_management_type is not null group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type )as a join (select a.block_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id,a.school_management_type)as b on a.block_id=b.block_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_cluster_last_30_days": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received,school_management_type from student_attendance_exception_data_last30 where school_management_type is not null group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,school_management_type )as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id,a.school_management_type)as b on a.cluster_id=b.cluster_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_school_last_30_days": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name, Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,school_management_type, (select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from student_attendance_exception_data_last30 where school_management_type is not null group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,school_management_type "
  },
  {
    "stud_att_management_exception_district_overall": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date, (select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) from (select district_id ,district_name,district_latitude,district_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received,school_management_type from student_attendance_exception_data_overall where school_management_type is not null group by district_id,district_name,district_latitude,district_longitude,school_management_type)as a join (select a.district_id,a.school_management_type,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id,a.school_management_type)as b on a.district_id=b.district_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_block_overall": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date, (select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received,school_management_type from student_attendance_exception_data_overall where school_management_type is not null group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,school_management_type )as a join (select a.block_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id,a.school_management_type)as b on a.block_id=b.block_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_cluster_overall": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools, a.total_schools_not_received as Total_schools_with_missing_data,a.school_management_type, round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date, (select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received,school_management_type from student_attendance_exception_data_overall where school_management_type is not null group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,school_management_type)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools,school_management_type from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id,school_management_type)as b on a.cluster_id=b.cluster_id and a.school_management_type=b.school_management_type where a.school_management_type is not null "
  },
  {
    "stud_att_management_exception_school_overall": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_management_type, Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date, (select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) from student_attendance_exception_data_overall where school_management_type is not null group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,school_management_type "
  },
  {
    "stud_att_exception_district_by_month_year": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received,month,year from student_attendance_exception_agg group by district_id,district_name,district_latitude,district_longitude,month,year)as a join (select a.district_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id)as b on a.district_id=b.district_id"
  },
  {
    "stud_att_exception_block_by_month_year": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received,month,year from student_attendance_exception_agg group by district_id,district_name,block_id,block_name,block_latitude,block_longitude,month,year)as a join (select a.block_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id)as b on a.block_id=b.block_id"
  },
  {
    "stud_att_exception_cluster_by_month_year": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,a.month,a.year,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,month,year,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_agg group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,month,year)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id)as b on a.cluster_id=b.cluster_id"
  },
  {
    "stud_att_exception_school_by_month_year": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,month,year,(select Data_from_date(year,month)),(select case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY') else Data_upto_date(year,month) end as Data_upto_date) from student_attendance_exception_agg group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude,month,year"
  },
  {
    "stud_att_exception_district_last_day": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_lastday group by district_id,district_name,district_latitude,district_longitude)as a join (select a.district_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id)as b on a.district_id=b.district_id"
  },
  {
    "stud_att_exception_block_last_day": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_lastday group by district_id,district_name,block_id,block_name,block_latitude,block_longitude)as a join (select a.block_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id)as b on a.block_id=b.block_id"
  },
  {
    "stud_att_exception_cluster_last_day": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude, Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_lastday group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id)as b on a.cluster_id=b.cluster_id"
  },
  {
    "stud_att_exception_school_last_day": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'1days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from student_attendance_exception_data_lastday group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude"
  },
  {
    "stud_att_exception_district_last_7_days": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)from (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last7 group by district_id,district_name,district_latitude,district_longitude)as a join (select a.district_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id)as b on a.district_id=b.district_id"
  },
  {
    "stud_att_exception_block_last_7_days": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period), (select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last7 group by district_id,district_name,block_id,block_name,block_latitude,block_longitude)as a join (select a.block_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id)as b on a.block_id=b.block_id"
  },
  {
    "stud_att_exception_cluster_last_7_days": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last7 group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id)as b on a.cluster_id=b.cluster_id"
  },
  {
    "stud_att_exception_school_last_7_days": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'7days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from student_attendance_exception_data_last7 group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude"
  },
  {
    "stud_att_exception_district_last_30_days": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)from (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last30 group by district_id,district_name,district_latitude,district_longitude)as a join (select a.district_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id)as b on a.district_id=b.district_id"
  },
  {
    "stud_att_exception_block_last_30_days": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)from (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last30 group by district_id,district_name,block_id,block_name,block_latitude,block_longitude)as a join (select a.block_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id)as b on a.block_id=b.block_id"
  },
  {
    "stud_att_exception_cluster_last_30_days": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period)from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_last30 group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id)as b on a.cluster_id=b.cluster_id"
  },
  {
    "stud_att_exception_school_last_30_days": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select to_char(min(days_in_period.day),'DD-MM-YYYY') as data_from_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period),(select to_char(max(days_in_period.day),'DD-MM-YYYY') as data_upto_date from (select (generate_series('now()'::date-'30days'::interval,('now()'::date-'1day'::interval)::date,'1day'::interval)::date) as day) as days_in_period) from student_attendance_exception_data_last30 group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude"
  },
  {
    "stud_att_exception_district_overall": "select a.district_latitude,a.district_longitude,a.district_id,a.district_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt)from  (select district_id ,district_name,district_latitude,district_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_overall group by district_id,district_name,district_latitude,district_longitude)as a join (select a.district_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.district_id)as b on a.district_id=b.district_id"
  },
  {
    "stud_att_exception_block_overall": "select a.block_latitude,a.block_longitude,a.district_id,a.district_name,a.block_id,a.block_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt)from  (select district_id ,district_name,block_id,block_name,block_latitude,block_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_overall group by district_id,district_name,block_id,block_name,block_latitude,block_longitude)as a join (select a.block_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.block_id)as b on a.block_id=b.block_id"
  },
  {
    "stud_att_exception_cluster_overall": "select a.cluster_latitude,a.cluster_longitude,a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,b.total_schools,a.total_schools_not_received as Total_schools_with_missing_data,round((cast(a.total_schools_not_received as numeric)/cast(b.total_schools as numeric))*100.0,2) as percentage_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) from (select district_id ,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude,Count(DISTINCT(school_id)) AS total_schools_not_received from student_attendance_exception_data_overall group by district_id,district_name,block_id,block_name,cluster_id,cluster_name,cluster_latitude,cluster_longitude)as a join (select a.cluster_id,count(distinct(a.school_id)) as total_schools from school_hierarchy_details as a inner join school_geo_master as b on a.school_id=b.school_id group by a.cluster_id)as b on a.cluster_id=b.cluster_id"
  },
  {
    "stud_att_exception_school_overall": "select school_latitude,school_longitude,district_id,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,Count(DISTINCT(school_id)) AS Total_schools_with_missing_data,(select Data_from_date(Min(year),min(month))  from student_attendance_trans where year = (select min(year) from student_attendance_trans) group by year) as data_from_date,(select   case when year=extract(year from now()) and month=extract(month from now()) then to_char(now(),'DD-MM-YYYY')   else Data_upto_date(year,month) end as data_upto_date from (select max(month) as month ,max(year) as year from student_attendance_trans where year = (select max(year) from student_attendance_trans)) as matt) from student_attendance_exception_data_overall group by district_id ,district_name,block_id,block_name,cluster_id,cluster_name,school_id,school_name,school_latitude,school_longitude"
  },
  {
    "stud_att_raw_meta": "select distinct case when month in (6,7,8,9,10,11,12) then (year ||'-'|| substring(cast((year+1) as text),3,2)) else ((year-1) || '-' || substring(cast(year as text),3,2)) end as academic_year FROM school_student_total_attendance WHERE block_latitude IS NOT NULL AND block_latitude <> 0 AND cluster_latitude IS NOT NULL AND cluster_latitude <> 0 AND school_latitude <>0 AND school_latitude IS NOT NULL AND school_name IS NOT NULL and cluster_name is not null and total_working_days>0 GROUP BY school_id,school_name,crc_name,school_latitude,school_longitude,year,month,cluster_id,cluster_name,crc_name,block_id,block_name,district_id,district_name,year,month"
  },
  {
    "stud_att_raw_district": "select * from student_attendance_all_months_data_dist;"
  },
  {
    "stud_att_raw_block": "select * from student_attendance_all_months_data_block;"
  },
  {
    "stud_att_raw_cluster": "select * from student_attendance_all_months_data_cluster;"
  },
  {
    "stud_att_raw_school": "select * from student_attendance_all_months_data_school;"
  }
]